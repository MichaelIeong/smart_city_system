module.exports = function (RED) {
    "use strict";

    function CompositionNode(n) {
        RED.nodes.createNode(this, n);
        var node = this;
        this.compositionName = n.compositionName;
        this.projectId = n.projectId;

        let flowNodes = [];
        RED.nodes.eachNode(function(n) {
            flowNodes.push(n);
        });
        let flowJson = JSON.stringify(flowNodes, null, 2);

        fetch('http://127.0.0.1:8080/api/services/uploadservice', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: flowJson
        })

    }

    RED.nodes.registerType("Composition", CompositionNode);
};